@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  html,
  body {
    overflow-x: hidden;
    max-width: 100%;
  }

  body {
    @apply bg-page dark:bg-page-dark text-text dark:text-text-dark;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    line-height: 1.6;
  }

  a {
    @apply text-primary transition-colors;
  }

  a:hover {
    @apply text-primary-dark;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    @apply font-medium leading-tight;
  }
}

@layer components {
  /* Primary button with theme-aware text color */
  .btn-primary {
    color: var(--color-btn-primary-text);
  }

  .navbar {
    @apply bg-navbar-bg dark:bg-navbar-bg-dark py-0 shadow-md sticky top-0 z-30;
    color: var(--color-navbar-text);
  }

  .navbar-brand {
    @apply font-bold text-xl pl-1 pr-4 py-2;
    color: var(--color-navbar-text);
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
  }

  .navbar-brand:hover {
    color: var(--color-navbar-text);
    background-color: rgba(255, 255, 255, 0.1);
  }

  .nav-link {
    @apply font-medium px-4 py-4 relative transition-all hover:no-underline text-[14px];
    color: var(--color-navbar-text-secondary);
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
  }

  .nav-link:hover {
    color: var(--color-navbar-text);
    background-color: rgba(255, 255, 255, 0.1);
  }

  .nav-link.active {
    color: var(--color-navbar-text);
    background-color: rgba(255, 255, 255, 0.2);
    box-shadow: inset 0 -3px 0 var(--color-navbar-text);
  }

  .link-card {
    @apply bg-card-bg dark:bg-card-bg-dark border border-gray-200 dark:border-neutral-700 rounded-lg mb-4 shadow-sm hover:shadow-md transition-all duration-200;
    overflow: hidden;
  }

  .card-body {
    @apply p-4 relative;
    overflow-wrap: break-word;
    word-wrap: break-word;
    word-break: break-word;
  }

  .card-title {
    @apply text-lg font-bold mb-2 leading-snug;
  }

  .card-title a {
    color: var(--color-text-primary);
    text-decoration: none;
  }

  .card-title a:hover {
    @apply text-primary;
  }

  .card-footer {
    @apply bg-gray-50 dark:bg-neutral-800 border-t border-gray-200 dark:border-neutral-700 px-4 py-3 text-sm text-text-muted dark:text-text-dark-muted;
  }

  .vote-box {
    @apply flex flex-col items-center p-1 min-w-[50px] mr-3;
  }

  .vote-btn {
    @apply bg-transparent border-none text-primary w-8 h-8 p-0 my-0.5 flex items-center justify-center text-lg transition-all rounded-full;
  }

  .vote-btn:hover:not(:disabled) {
    @apply text-primary-light scale-110 bg-gray-100 dark:bg-neutral-800;
  }

  .vote-btn:disabled {
    @apply text-gray-300 dark:text-gray-600 cursor-not-allowed;
  }

  .vote-btn.vote-down {
    @apply text-danger;
  }

  .vote-btn.vote-down:hover:not(:disabled) {
    @apply text-red-400 bg-red-50 dark:bg-red-900/20;
  }

  .vote-count {
    @apply font-bold text-lg my-1 text-primary dark:text-primary-light;
  }

  .tag {
    @apply inline-block bg-blue-50 dark:bg-blue-900/40 text-primary dark:text-blue-300 rounded-full px-3 py-1 text-xs mr-2 mb-2 no-underline transition-colors border border-blue-100 dark:border-blue-800;
  }

  .tag:hover {
    @apply bg-primary dark:bg-primary-dark border-primary dark:border-primary-dark no-underline;
    color: var(--color-btn-primary-text);
  }

  .btn {
    @apply px-4 py-2 rounded-md font-medium text-center transition-colors;
  }

  .btn-primary {
    @apply bg-primary hover:bg-primary-dark;
    /* text color from var(--color-btn-primary-text) defined above */
  }

  .btn-secondary {
    @apply bg-gray-200 dark:bg-neutral-700 hover:bg-gray-300 dark:hover:bg-neutral-600 text-text dark:text-text-dark;
  }

  /* Fix for links with button-like styling - prevent text color change on hover */
  a.bg-primary,
  a.bg-primary:hover,
  a.bg-primary:visited {
    color: var(--color-btn-primary-text);
  }

  .btn-outline {
    @apply border border-primary text-primary hover:bg-primary dark:hover:bg-primary-dark;
    &:hover {
      color: var(--color-btn-primary-text);
    }
  }

  .alert {
    @apply rounded-lg p-4 mb-5 border shadow-sm;
  }

  .alert-success {
    @apply bg-green-50 dark:bg-green-900/20 border-success/30 dark:border-success/30 text-green-800 dark:text-green-300;
  }

  .alert-danger {
    @apply bg-red-50 dark:bg-red-900/20 border-danger/30 dark:border-danger/30 text-red-800 dark:text-red-300;
  }

  .alert-warning {
    @apply bg-amber-50 dark:bg-amber-900/20 border-amber-300 dark:border-amber-700 text-amber-800 dark:text-amber-300;
  }

  .alert-info {
    @apply bg-blue-50 dark:bg-blue-900/20 border-blue-300 dark:border-blue-700 text-blue-800 dark:text-blue-300;
  }

  .form-input {
    @apply w-full rounded-lg border border-gray-300 dark:border-neutral-600 dark:bg-input-bg-dark px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent;
  }

  select.form-input {
    @apply dark:bg-input-bg-dark dark:text-text-dark;
  }

  /* Custom checkbox styles using theme primary color */
  input[type='checkbox'] {
    @apply appearance-none cursor-pointer border-2;
    background-color: var(--color-bg-input);
    background-image: none;
  }

  input[type='checkbox']:checked {
    background-color: var(--color-primary);
    border-color: var(--color-primary);
    background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e");
    background-size: 100% 100%;
    background-position: center;
    background-repeat: no-repeat;
  }

  input[type='checkbox']:hover:not(:checked) {
    border-color: var(--color-border-strong);
  }

  input[type='checkbox']:focus {
    outline: none;
    box-shadow: 0 0 0 3px rgba(var(--color-primary-rgb), 0.2);
  }

  .dark input[type='checkbox'] {
    background-color: var(--color-bg-input);
  }

  .dark input[type='checkbox']:hover:not(:checked) {
    border-color: var(--color-border-strong);
  }

  .dark input[type='checkbox']:checked {
    background-color: var(--color-primary);
    border-color: var(--color-primary);
  }

  footer {
    @apply bg-navbar-bg dark:bg-navbar-bg-dark py-8 mt-12;
    color: var(--color-navbar-text);
  }

  footer h5 {
    @apply font-semibold mb-4;
    color: var(--color-navbar-text);
  }

  footer a {
    @apply no-underline transition-colors;
    color: var(--color-navbar-text-secondary);
  }

  footer a:hover {
    @apply underline;
    color: var(--color-navbar-text);
  }

  .stats-box {
    @apply dark:bg-stats-bg-dark dark:border-neutral-700 rounded-lg p-3;
  }

  .spinner {
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(360deg);
    }
  }

  .page-enter-active,
  .page-leave-active {
    transition: opacity 0.3s;
  }
  .page-enter,
  .page-leave-to {
    opacity: 0;
  }


  @media (max-width: 768px) {
    .menu-button {
      margin-right: 0 !important;
    }

    .navbar-brand {
      margin-right: auto;
    }

    .mobile-menu-container {
      width: 100% !important;
    }

    .mobile-fab {
      bottom: 1.5rem !important;
      right: 1.5rem !important;
    }
  }
}

@layer utilities {
  /* Utility class for primary button text color */
  .btn-primary-text {
    color: var(--color-btn-primary-text);
  }

  /* Utility class for navbar text color */
  .navbar-text {
    color: var(--color-navbar-text);
  }

  .navbar-text-secondary {
    color: var(--color-navbar-text-secondary);
  }

  /* Theme-aware card background - replaces bg-white dark:bg-card-dark */
  .card-bg {
    background-color: var(--color-bg-card);
  }

  /* Theme-aware subtle background */
  .bg-subtle {
    background-color: var(--color-bg-subtle);
  }

  /* Large emoji sizes for ::emoji:: and :::emoji::: syntax */
  .emoji-lg {
    font-size: 2.5rem;
    line-height: 1;
    vertical-align: middle;
  }

  .emoji-xl {
    font-size: 4rem;
    line-height: 1;
    vertical-align: middle;
  }
}

footer.gradient-bg {
  background: linear-gradient(135deg, var(--color-navbar-bg) 0%, var(--color-navbar-bg) 100%);
}

.theme-renegados footer.gradient-bg,
.theme-yups footer.gradient-bg,
.theme-barrapunto footer.gradient-bg,
.theme-dark footer.gradient-bg {
  background: linear-gradient(135deg, var(--color-navbar-bg) 0%, var(--color-navbar-bg) 100%);
}

.dark footer.gradient-bg {
  background: linear-gradient(
    135deg,
    var(--color-navbar-bg-dark) 0%,
    var(--color-navbar-bg-dark) 100%
  );
}

footer .border-t {
  border-top-width: 1px;
}

footer .border-opacity-10 {
  --tw-border-opacity: 0.1;
}

footer .border-white {
  border-color: rgba(255, 255, 255, var(--tw-border-opacity));
}

footer .border-primary {
  border-color: var(--color-primary);
}

.dark footer .border-primary {
  border-color: var(--color-primary-dark);
}

footer .space-y-2 > * + * {
  margin-top: 0.5rem;
}

footer .space-x-4 > * + * {
  margin-left: 1rem;
}

footer .opacity-70 {
  opacity: 0.7;
}

footer .opacity-80 {
  opacity: 0.8;
}

@media (max-width: 768px) {
  footer .border-t.border-primary.pt-6 {
    flex-direction: column;
    align-items: center;
  }

  footer .border-t.border-primary.pt-6 > div:first-child {
    margin-bottom: 1rem;
    order: 2;
  }

  footer .border-t.border-primary.pt-6 > div:last-child {
    margin-bottom: 1rem;
    order: 1;
  }
}

/* Override text color for primary buttons to use theme-aware color */
/* This ensures buttons work correctly on themes like hacker (green bg needs black text) */
.bg-primary,
.bg-primary-dark,
.bg-primary-light {
  color: var(--color-btn-primary-text);
}

/* Accessibility: Respect user preference for reduced motion */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }

  .spinner {
    animation: none;
  }

  .page-enter-active,
  .page-leave-active {
    transition: none;
  }
}

/* NSFW Image Blur Styles */
.nsfw-image-container {
  position: relative;
  display: inline-block;
  cursor: pointer;
  overflow: hidden;
  border-radius: 0.5rem;
}

.nsfw-blur-wrapper {
  display: block;
}

.nsfw-blur-wrapper img {
  filter: blur(30px);
  transition: filter 0.3s ease, opacity 0.3s ease;
}

.nsfw-overlay {
  position: absolute;
  inset: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background-color: rgba(0, 0, 0, 0.6);
  transition: opacity 0.3s ease;
  padding: 1rem;
}

.nsfw-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  max-width: 280px;
}

/* Title: "Contenido para adultos" */
.nsfw-title::after {
  content: var(--nsfw-title, 'Adult content');
  display: block;
  color: white;
  font-weight: 700;
  font-size: 1.125rem;
  margin-bottom: 0.5rem;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
}

/* Subtitle: "Solo mayores de 18 años" */
.nsfw-adult-only::after {
  content: var(--nsfw-adult-only, '18+ only');
  display: block;
  color: #fca5a5;
  font-weight: 600;
  font-size: 0.875rem;
  margin-bottom: 1rem;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
}

/* Button: "Soy mayor de 18 años, Entrar" */
.nsfw-enter-btn {
  display: inline-block;
  background-color: #dc2626;
  border-radius: 0.375rem;
  padding: 0.5rem 1rem;
  transition: background-color 0.2s ease;
}

.nsfw-enter-btn:hover {
  background-color: #b91c1c;
}

.nsfw-enter-btn::after {
  content: var(--nsfw-enter, 'I am 18+, Enter');
  color: white;
  font-weight: 500;
  font-size: 0.875rem;
  white-space: nowrap;
}

/* Revealed state - remove blur when clicked */
.nsfw-image-container.nsfw-revealed .nsfw-blur-wrapper img {
  filter: none;
}

.nsfw-image-container.nsfw-revealed .nsfw-overlay {
  opacity: 0;
  pointer-events: none;
}
